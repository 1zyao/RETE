import{R as $,r as v,j as d,b as e,E as fe,F as re}from"./echarts.a2342df2.js";import{t as $e,r as oe,i as ae,u as H,v as Le,C as J,l as t,E as ne,a as Ie,T as Ne,e as je,m as z,w as rt,x as te,y as X,z as ot,A as pe,g as we,B as at}from"./index.6f0e4d59.js";import{r as ie}from"./codemirror.220945bf.js";import{e as Q,a0 as q,G as T,N,O as j,Q as W,R as ee,P as We,F as nt,ay as it,f as Y,U as st,L as lt,C as ut,q as ct,g as U,aN as he,a3 as dt,V as ft,w as pt,k as Ee,l as Z,aO as ht,aP as mt}from"./dataGrid.1fd49c94.js";function xt(r,o,a,p){var h=-1,i=r==null?0:r.length;for(p&&i&&(a=r[++h]);++h<i;)a=o(a,r[h],h,r);return a}var gt=xt;function vt(r){return function(o){return r==null?void 0:r[o]}}var bt=vt,yt=bt,Ct={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},kt=yt(Ct),Tt=kt,St=Tt,wt=$e,Et=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Mt="\\u0300-\\u036f",Rt="\\ufe20-\\ufe2f",_t="\\u20d0-\\u20ff",At=Mt+Rt+_t,Ot="["+At+"]",$t=RegExp(Ot,"g");function Lt(r){return r=wt(r),r&&r.replace(Et,St).replace($t,"")}var It=Lt,Nt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function jt(r){return r.match(Nt)||[]}var Wt=jt,zt=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function Dt(r){return zt.test(r)}var Ut=Dt,ze="\\ud800-\\udfff",Pt="\\u0300-\\u036f",Ft="\\ufe20-\\ufe2f",Ht="\\u20d0-\\u20ff",Gt=Pt+Ft+Ht,De="\\u2700-\\u27bf",Ue="a-z\\xdf-\\xf6\\xf8-\\xff",Bt="\\xac\\xb1\\xd7\\xf7",Zt="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",qt="\\u2000-\\u206f",Vt=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Pe="A-Z\\xc0-\\xd6\\xd8-\\xde",Yt="\\ufe0e\\ufe0f",Fe=Bt+Zt+qt+Vt,He="['\u2019]",Me="["+Fe+"]",Jt="["+Gt+"]",Ge="\\d+",Kt="["+De+"]",Be="["+Ue+"]",Ze="[^"+ze+Fe+Ge+De+Ue+Pe+"]",Xt="\\ud83c[\\udffb-\\udfff]",Qt="(?:"+Jt+"|"+Xt+")",er="[^"+ze+"]",qe="(?:\\ud83c[\\udde6-\\uddff]){2}",Ve="[\\ud800-\\udbff][\\udc00-\\udfff]",V="["+Pe+"]",tr="\\u200d",Re="(?:"+Be+"|"+Ze+")",rr="(?:"+V+"|"+Ze+")",_e="(?:"+He+"(?:d|ll|m|re|s|t|ve))?",Ae="(?:"+He+"(?:D|LL|M|RE|S|T|VE))?",Ye=Qt+"?",Je="["+Yt+"]?",or="(?:"+tr+"(?:"+[er,qe,Ve].join("|")+")"+Je+Ye+")*",ar="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",nr="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",ir=Je+Ye+or,sr="(?:"+[Kt,qe,Ve].join("|")+")"+ir,lr=RegExp([V+"?"+Be+"+"+_e+"(?="+[Me,V,"$"].join("|")+")",rr+"+"+Ae+"(?="+[Me,V+Re,"$"].join("|")+")",V+"?"+Re+"+"+_e,V+"+"+Ae,nr,ar,Ge,sr].join("|"),"g");function ur(r){return r.match(lr)||[]}var cr=ur,dr=Wt,fr=Ut,pr=$e,hr=cr;function mr(r,o,a){return r=pr(r),o=a?void 0:o,o===void 0?fr(r)?hr(r):dr(r):r.match(o)||[]}var xr=mr,gr=gt,vr=It,br=xr,yr="['\u2019]",Cr=RegExp(yr,"g");function kr(r){return function(o){return gr(br(vr(o).replace(Cr,"")),r,"")}}var Tr=kr,Sr=Tr,wr=Sr(function(r,o,a){return r+(a?"_":"")+o.toLowerCase()}),se=wr,me={},Er=ae.exports;Object.defineProperty(me,"__esModule",{value:!0});var Ke=me.default=void 0,Mr=Er(oe()),Rr=ie,_r=(0,Mr.default)((0,Rr.jsx)("path",{d:"M8 5v14l11-7z"}),"PlayArrow");Ke=me.default=_r;var xe={},Ar=ae.exports;Object.defineProperty(xe,"__esModule",{value:!0});var Xe=xe.default=void 0,Or=Ar(oe()),$r=ie,Lr=(0,Or.default)((0,$r.jsx)("path",{d:"M6 6h12v12H6z"}),"Stop");Xe=xe.default=Lr;var ge={},Ir=ae.exports;Object.defineProperty(ge,"__esModule",{value:!0});var ve=ge.default=void 0,Nr=Ir(oe()),jr=ie,Wr=(0,Nr.default)((0,jr.jsx)("path",{d:"M10 6 8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"}),"ChevronRight");ve=ge.default=Wr;var be={},zr=ae.exports;Object.defineProperty(be,"__esModule",{value:!0});var Qe=be.default=void 0,Dr=zr(oe()),Ur=ie,Pr=(0,Dr.default)((0,Ur.jsx)("path",{d:"M3 14h4v-4H3v4zm0 5h4v-4H3v4zM3 9h4V5H3v4zm5 5h13v-4H8v4zm0 5h13v-4H8v4zM8 5v4h13V5H8z"}),"ViewList");Qe=be.default=Pr;const F=1024*1024,le=F*1024,Fr=1e3*1e3*30,de=r=>r.map(({value:o,seriesName:a})=>a+": "+pe(o*F)).join("<br>"),Hr=$.memo(()=>{var ye,Ce,ke,Te,Se;const r=H(),o=Q(),[a,p]=v.exports.useState([]);v.exports.useEffect(()=>{const m=r.on("profiler:current",M=>p(L=>(L.length>25&&L.shift(),M.time=Le(),[...L,M])));return()=>{m()}},[]);const h=[],i=[],l=[],s=[],f=[],x=[],c=[],n=[],u=[],E=[],C=[],A=[],R=[],w=[],y=[],_=[],O=[],S=[];a.forEach(m=>{var L;h.push(m.time),i.push(m.tps.toFixed(2)),l.push(m.mspt.toFixed(2)),s.push(m.chunkLoads),f.push(m.chunkUnloads),x.push((m.cpu*100).toFixed(2)),c.push(m.temperature.toFixed(2)),n.push(m.memory/le),u.push(m.threads),E.push(m.reads/F),C.push(m.writes/F),A.push(m.sent/F),R.push(m.recv/F);let M=0;for(const G in m.gc){const[I,B]=m.gc[G];(O[M]||(O[M]=[])).push(I),(S[M]||(S[M]=[])).push(B),M++}(L=m.worlds)==null||L.forEach((G,I)=>{(w[I]||(w[I]=[])).push(G.entities),(y[I]||(y[I]=[])).push(G.tiles),(_[I]||(_[I]=[])).push(G.chunks)})});const K=Object.keys(((ye=a[a.length-1])==null?void 0:ye.gc)||{}),b=((ke=(Ce=a[a.length-1])==null?void 0:Ce.worlds)==null?void 0:ke.map(m=>m.name))||[],k=(Te=a[a.length-1])==null?void 0:Te.totalMemory,g=(m,M,L,G,I,B)=>e(T,{item:!0,sm:6,xs:12,lg:4,children:d(N,{children:[e(j,{title:m}),e(W,{}),e(fe,{style:{height:200},theme:o.palette.mode==="dark"?"dark":void 0,option:{backgroundColor:"rgba(0, 0, 0, 0)",legend:B?{data:B}:void 0,grid:{top:"8%",bottom:"14%",right:"5%"},xAxis:{data:h,boundaryGap:!1,type:"category"},tooltip:{formatter:L,trigger:"axis"},yAxis:{max:I,type:"value"},series:M.map((et,tt)=>({name:(B==null?void 0:B[tt])||m,data:et,areaStyle:G,type:"line",smooth:!0}))}})]})}),P=(Se=a[a.length-1])==null?void 0:Se.processorLoad;return d(q,{maxWidth:!1,sx:{py:3,position:"relative"},children:[e(J,{loading:!a.length}),d(T,{container:!0,spacing:3,children:[g("TPS",[i]),l[0]!=="-1.00"&&g(t.dashboard.mspt,[l],"{c} "+t.ms),g(t.worlds.entities,w,void 0,void 0,void 0,b),g(t.worlds.tiles,y,void 0,void 0,void 0,b),g(t.worlds.chunks,_,void 0,void 0,void 0,b),g(t.profiler.loadAndUnloadChunks,[s,f],void 0,void 0,void 0,[t.profiler.chunkLoads,t.profiler.chunkUnoads]),g(t.profiler.gcTime,O,m=>m.map(({value:M,seriesName:L})=>`${L}: ${X(M)}`).join("<br>"),void 0,void 0,K),g(t.profiler.gcCount,S,void 0,void 0,void 0,K),g(t.profiler.threads,[u]),x[0]!=="-100.00"&&g(t.profiler.cpu,[x],"{c} %",{},100),g(t.dashboard.memory,[n],([{value:m}])=>pe(m*le),{},k?Math.round(k/le):void 0),g(t.profiler.readsAndWrites,[E,C],de,void 0,void 0,[t.profiler.reads,t.profiler.writes]),g(t.profiler.network,[R,A],de,void 0,void 0,[t.profiler.recv,t.profiler.sent]),c[0]!=="0.00"&&g(t.profiler.temperature,[c],"{c} \u2103",{}),(P==null?void 0:P.length)>0&&e(T,{item:!0,sm:6,xs:12,lg:4,children:d(N,{children:[e(j,{title:t.profiler.cores}),e(W,{}),e(ee,{children:e(T,{container:!0,spacing:1,justifyContent:"center",children:P.map((m,M)=>e(T,{item:!0,children:e(We,{sx:{width:52,height:52,lineHeight:"52px",textAlign:"center",color:o.palette.primary.contrastText,display:"inline-block",position:"relative",overflow:"hidden",textShadow:o.palette.mode==="light"?"#000 1px 0 0, #000 0 1px 0, #000 -1px 0 0, #000 0 -1px 0":"#fff 1px 0 0, #fff 0 1px 0, #fff -1px 0 0, #fff 0 -1px 0","& span":{position:"relative",zIndex:2},"&:after":{content:'" "',position:"absolute",transition:".6s",backgroundColor:o.palette.primary.main,height:m*100+"%",width:"100%",bottom:0,left:0,right:0}},children:d("span",{children:[(m*100).toFixed(0),"%"]})})},M))})})]})})]})]})}),Gr=/- (\w+)/,Oe=({data:r})=>t.profiler.timingsCount+": "+r.count,D=$.memo(({title:r,data:o,formatter:a})=>e(T,{item:!0,sm:6,xs:12,children:d(N,{children:[e(j,{title:r}),e(W,{}),o.length?e(fe,{style:{height:300},theme:Q().palette.mode==="dark"?"dark":void 0,option:{backgroundColor:"rgba(0, 0, 0, 0)",itemStyle:{borderRadius:5,borderColor:"rgba(0, 0, 0, 0)",borderWidth:4},tooltip:{trigger:"item",formatter:a},series:[{type:"pie",radius:"50%",data:o,emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]}}):e(ee,{children:e(ne,{})})]})})),Br=$.memo(()=>{const r=H(),o=Q(),{isTimingsV1:a}=Ie(),[p,h]=v.exports.useState(!1),[i,l]=v.exports.useState(null);v.exports.useEffect(()=>{const c=r.emit("profiler:timingsStatus",h).on("profiler:timings",l);return()=>{c()}},[]);const[s,f,x]=v.exports.useMemo(()=>{if(!i)return[];const c={},n={},u={};i.data.forEach(C=>u[C[0]]=C);const E=(C,A)=>{const R=u[C];if(!R)return;u[C]=void 0;const[,w,y]=R,_=i.handlers[C]||[0,t.unknown],O=i.groups[_[0]]||t.unknown,S=_[1],K=R[R.length-1];if(a){if(S.startsWith("tickEntity - ")){const b=S.slice(13).replace(/^Entity(Mob)?/,""),k=se(b),g=c[k];g?(g.count+=w,g.value+=y):c[k]={count:w,value:y,name:z["entity.minecraft."+k]||b}}else if(S.startsWith("tickTileEntity - ")){const b=S.slice(17).replace(/^TileEntity(Mob)?/,""),k=se(b),g=n[k];g?(g.count+=w,g.value+=y):n[k]={count:w,value:y,name:z["block.minecraft."+k]||b}}}else if(S.startsWith("tickEntity - ")&&S.endsWith("ick")){const b=Gr.exec(S);if(b){const k=c[b[1]];k?(k.count+=w,k.value+=y):c[b[1]]={count:w,value:y,name:z["entity.minecraft."+b[1]]||b[1]}}}else if(S.startsWith("tickTileEntity - ")){const b=S.split("."),k=b[b.length-1].replace(/^TileEntity(Mob)?/,""),g=se(k),P=n[g];P?(P.count+=w,P.value+=y):n[g]={count:w,value:y,name:z["block.minecraft."+g]||k}}return e(te,{nodeId:C.toString(),label:d(Y,{sx:{"& .info, .count":{color:"transparent"},"&:hover .count":{color:"inherit"},"&:hover .info":{color:o.palette.primary.contrastText,textShadow:o.palette.mode==="light"?"#000 1px 0 0, #000 0 1px 0, #000 -1px 0 0, #000 0 -1px 0":"#fff 1px 0 0, #fff 0 1px 0, #fff -1px 0 0, #fff 0 -1px 0"}},children:[d(Y,{sx:{position:"relative",zIndex:2,display:"flex",alignItems:"center"},children:[O!=="Minecraft"&&d(re,{children:[e(U,{color:"primary",component:"span",children:a?"Bukkit":t.plugin+":"+O}),"::"]}),S,"\xA0",d(U,{variant:"caption",className:"count",children:["(",t.profiler.timingsCount,": ",w,")"]})]}),d(Y,{className:"info",sx:{position:"absolute",height:10,right:0,top:"50%",marginTop:"-5px",minWidth:40,display:"flex",justifyContent:"center",alignItems:"center"},children:[d(U,{variant:"caption",sx:{position:"absolute"},children:["(",Math.round(100*A),"%)"]}),e("div",{style:{width:100*A+"px"},className:"bar"})]})]}),children:Array.isArray(K)&&K.sort((b,k)=>k[2]-b[2]).map(b=>E(b[0],A*(b[2]/y)))},C)};return[e(Ne,{defaultCollapseIcon:e(je,{}),defaultExpandIcon:e(ve,{}),defaultExpanded:["1"],children:E(1,1)}),Object.values(c),Object.values(n)]},[i]);return e(q,{maxWidth:!1,sx:{py:3},children:d(T,{container:!0,spacing:3,children:[e(T,{item:!0,xs:12,children:d(N,{children:[e(j,{title:"Timings",sx:{position:"relative"},action:e(nt,{control:e(it,{checked:p,onChange:c=>r.emit("profiler:timingsStatus",h,c.target.checked)}),label:z["addServer.resourcePack.enabled"],sx:rt})}),e(W,{}),p?d(Y,{sx:{position:"relative",minHeight:i?void 0:300,"& .bar":{backgroundColor:o.palette.primary.main,height:10,marginLeft:"auto",borderRadius:2}},children:[e(J,{loading:!i}),s]}):e(ee,{children:e(ne,{title:t.profiler.timingsNotStarted})})]})}),i&&e(D,{title:t.profiler.entitiesTick,data:f,formatter:Oe}),i&&e(D,{title:t.profiler.tilesTick,data:x,formatter:Oe})]})})}),ue=({name:r,value:o})=>r+": "+X(o/1e3),ce=(r,o,a)=>{const p=o/Fr,h=p.toFixed(2);return d(re,{children:[e(U,{color:"primary",component:"span",children:r}),":\xA0",t.profiler.lagTime," ",e("span",{className:"bold",children:X(o/1e3)}),", ",t.profiler.timingsCount,":\xA0",e("span",{className:"bold",children:a}),", \xA0",t.profiler.avgTime,": ",e("span",{className:"bold",children:X(o/1e3/a)}),", \xA0",d(U,{sx:{fontWeight:"bold",color:p>=100?"error.main":p>=50?"warning.main":void 0},component:"span",children:[h==="0.00"?0:h,"%"]})," ",t.profiler.ofTick]})},Zr=$.memo(()=>{const r=H(),[o,a]=v.exports.useState();return v.exports.useEffect(()=>{const p=r.emit("profiler:fetchPlugins").on("profiler:plugins",h=>{const i=[[],[],[]],l=[];for(const s in h){let f=0,x=0;const c=[];["events","tasks","commands"].forEach((n,u)=>{const E=s+"/"+n,C=[],A=h[s][u];let R=0,w=0;for(const y in A){const[_,O]=A[y];w+=_,x+=_,R+=O,f+=O;const S=`${E}/${y}`;C.push([O,e(te,{nodeId:S,label:ce(y,O,_)},S)])}R&&i[u].push({name:s,value:R}),C.length&&c.push(e(te,{nodeId:E,label:ce(t.profiler[n],R,w),children:C.sort((y,_)=>_[0]-y[0]).map(y=>y[1])},E))}),f&&l.push([f,e(te,{nodeId:s,label:ce(s,f,x),children:c},s)])}a([l.sort((s,f)=>f[0]-s[0]).map(s=>s[1]),i.map(s=>s.sort((f,x)=>x.value-f.value))])});return()=>{p()}},[]),d(q,{maxWidth:!1,sx:{py:3,position:"relative",height:o?void 0:"80vh"},children:[e(J,{loading:!o,background:!1}),o&&d(T,{container:!0,spacing:3,children:[e(T,{item:!0,xs:12,children:d(N,{children:[e(j,{title:t.profiler.pluginsTitle,sx:{position:"relative"}}),e(W,{}),o[0].length?e(Ne,{defaultCollapseIcon:e(je,{}),defaultExpandIcon:e(ve,{}),children:o[0]}):e(ee,{children:e(ne,{})})]})}),e(D,{title:t.profiler.pluginsEventsTime,data:o[1][0],formatter:ue}),e(D,{title:t.profiler.pluginsTasksTime,data:o[1][1],formatter:ue}),e(D,{title:t.profiler.pluginsCommandsTime,data:o[1][2],formatter:ue})]})]})}),qr=[{field:"world",headerName:t.worlds.name,minWidth:200},{field:"x",headerName:"X",width:100},{field:"z",headerName:"Z",width:100},{field:"count",headerName:t.profiler.count,width:100}],Vr=$.memo(()=>{const r=H(),[o,a]=$.useState(),[p,h]=$.useState(),[i,l]=v.exports.useState();v.exports.useEffect(()=>{r.emit("profiler:entities",c=>{c[2].forEach((n,u)=>n.id=u),c[3].forEach((n,u)=>n.id=u),l([Object.entries(c[0]).map(([n,u])=>({value:u,name:z["entity.minecraft."+n.toLowerCase()]||n})).sort((n,u)=>u.value-n.value),Object.entries(c[1]).map(([n,u])=>({value:u,name:z["block.minecraft."+n.toLowerCase()]||n})).sort((n,u)=>u.value-n.value),c[2],c[3]])})},[]);const s=v.exports.useMemo(()=>{const c=o;return c==null||!i?null:Object.entries(i[2][c].data).map(([n,u])=>({value:u,name:z["entity.minecraft."+n.toLowerCase()]||n})).sort((n,u)=>u.value-n.value)},[o,i]),f=v.exports.useMemo(()=>{const c=p;return c==null||!i?null:Object.entries(i[3][c].data).map(([n,u])=>({value:u,name:z["block.minecraft."+n.toLowerCase()]||n})).sort((n,u)=>u.value-n.value)},[p,i]),x=(c,n,u,E)=>e(T,{item:!0,sm:6,xs:12,children:d(N,{children:[e(j,{title:n}),e(W,{}),e("div",{style:{height:"70vh",position:"relative"},children:e(he,{checkboxSelection:!0,disableColumnMenu:!0,disableSelectionOnClick:!0,disableDensitySelector:!0,rows:c,columns:qr,onSelectionModelChange:C=>E(C.find(A=>A!==u)),selectionModel:u==null?[]:[u]})})]})});return d(q,{maxWidth:!1,sx:{py:3,"& .MuiDataGrid-root":{border:"none"},position:"relative",height:i?void 0:"80vh"},children:[e(J,{loading:!i,background:!1}),i&&d(T,{container:!0,spacing:3,children:[x(i[2],t.profiler.crowdEntities,o,a),x(i[3],t.profiler.crowdTiles,p,h),s&&e(D,{title:t.worlds.entities,data:s}),f&&e(D,{title:t.worlds.tiles,data:f}),e(D,{title:t.profiler.globalEntities,data:i[0]}),e(D,{title:t.profiler.globalTiles,data:i[1]})]})]})}),Yr=$.memo(()=>{const r=H(),o=Q(),[a,p]=v.exports.useState([]),[h,i]=v.exports.useState(0);return v.exports.useEffect(()=>{const l=r.on("profiler:gc",s=>{p(f=>{let x=f.length;return x>15?f.shift():x++,s.start=Le(),[s,...f]})});return()=>{l()}},[]),e(q,{maxWidth:!1,sx:{py:3},children:d(T,{container:!0,spacing:3,children:[e(T,{item:!0,xs:12,lg:4,children:d(N,{children:[e(j,{title:t.profiler.carbageCollection}),e(W,{}),a.length?e(st,{dense:!0,children:a.map((l,s)=>e(lt,{secondaryAction:e(ut,{edge:"start",checked:s===h,tabIndex:-1,onClick:()=>i(s)}),children:e(ct,{primary:d(re,{children:["[",l.start,"] ",e("span",{className:"bold",children:l.name})]}),secondary:d(re,{children:[d(U,{component:"span",variant:"body2",color:"text.primary",children:[t.profiler.costTime,": "]}),X(l.duration),e("br",{}),d(U,{component:"span",variant:"body2",color:"text.primary",children:[t.cause,": "]}),l.cause,e("br",{}),d(U,{component:"span",variant:"body2",color:"text.primary",children:[t.profiler.action,": "]}),l.action]})})},l.id))}):e(ee,{children:e(ne,{})})]})}),a[h]&&e(T,{item:!0,xs:12,lg:8,children:d(N,{children:[e(j,{title:t.profiler.memoryUsage,sx:{position:"relative"}}),e(W,{}),e(fe,{style:{height:"80vh"},theme:o.palette.mode==="dark"?"dark":void 0,option:{backgroundColor:"rgba(0, 0, 0, 0)",legend:{data:t.profiler.memoryUsageTypes},itemStyle:{borderRadius:5,borderColor:"rgba(0, 0, 0, 0)",borderWidth:4},tooltip:{trigger:"axis",formatter:de},xAxis:{type:"value",boundaryGap:[0,.01]},yAxis:{type:"category",data:Object.keys(a[h].after)},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},series:[{name:t.profiler.memoryUsageTypes[0],type:"bar",data:Object.values(a[h].after).map(l=>({origin:l,value:(l/F).toFixed(2)}))},{name:t.profiler.memoryUsageTypes[1],type:"bar",data:Object.values(a[h].before).map(l=>({origin:l,value:(l/F).toFixed(2)}))}]}})]})})]})})}),Jr=$.memo(()=>{const r=H(),[o,a]=$.useState([{field:"size",sort:"desc"}]),[p,h]=v.exports.useState([]),[i,l]=v.exports.useState(null);v.exports.useEffect(()=>{r.emit("profiler:heap",(f,x)=>{const c=[];for(const n in f)c.push({id:ot(n),count:f[n][0],size:f[n][1],display:pe(f[n][1])});h(c),console.log(x),l(x)})},[]);const s=v.exports.useMemo(()=>{const f=[{field:"id",headerName:t.profiler.className,minWidth:250,flex:.6},{field:"count",headerName:t.profiler.count,width:100},{field:"size",headerName:t.size,width:100,valueFormatter:({value:{display:x}})=>x}];return i&&f.splice(1,0,{field:"_",headerName:t.profiler.classLoader,minWidth:150,flex:.4,valueFormatter:({id:x})=>i[x]||""}),f},[i]);return e(q,{maxWidth:!1,sx:{py:3,"& .MuiDataGrid-root":{border:"none"}},children:e(T,{container:!0,spacing:3,children:e(T,{item:!0,xs:12,children:d(N,{children:[e(j,{title:t.profiler.heap}),e(W,{}),d("div",{style:{height:"70vh",position:"relative"},children:[e(J,{loading:!p.length}),e(he,{disableColumnMenu:!0,disableSelectionOnClick:!0,rows:p,columns:s,sortingOrder:["desc","asc"],sortModel:o,onSortModelChange:a})]})]})})})})}),Kr=$.memo(()=>{const r=H(),[o,a]=v.exports.useState(-1),[p,h]=v.exports.useState([]);v.exports.useEffect(()=>{r.emit("profiler:threads",(l,s)=>{h(l),a(s)})},[]);const i=[{field:"id",headerName:"PID",minWidth:80},{field:"name",headerName:t.profiler.threadName,minWidth:200,flex:1,renderCell:({value:l,row:{id:s}})=>s===o?e(U,{color:"primary",children:t.profiler.serverThread}):l},{field:"state",headerName:t.profiler.state,width:150,renderCell:({value:l,row:{lock:s}})=>{const f=t.profiler.threadState[l]||l;return s?e(dt,{onClick:()=>we({content:s,title:t.profiler.lock,cancelButton:!1}),underline:"hover",children:f}):f}},{field:"stack",headerName:t.profiler.stack,width:100,renderCell:({value:l})=>l&&e(ft,{size:"small",onClick:()=>we({content:l,cancelButton:!1,title:t.profiler.stack}),children:e(Qe,{})})}];return e(q,{maxWidth:!1,sx:{py:3,"& .MuiDataGrid-root":{border:"none"}},children:e(T,{container:!0,spacing:3,children:e(T,{item:!0,xs:12,children:d(N,{children:[e(j,{title:t.profiler.threads}),e(W,{}),d("div",{style:{height:"70vh",position:"relative"},children:[e(J,{loading:!p.length}),e(he,{disableColumnMenu:!0,disableSelectionOnClick:!0,rows:p,columns:i})]})]})})})})}),Xr=[Hr,Br,Zr,Yr,Vr,Jr,Kr],oo=()=>{const r=H(),o=Q(),a=Ie(),[p,h]=v.exports.useState(0),[i,l]=v.exports.useState(0),[s,f]=v.exports.useState(!!a.profilerStarted);v.exports.useEffect(()=>{const u=r.on("profiler:status",f);return()=>{u()}},[]);const x={enter:o.transitions.duration.enteringScreen,exit:o.transitions.duration.leavingScreen},c=Xr[p],n=(u,E,C)=>e(ht,{in:C,timeout:x,style:{transitionDelay:(C?x.exit:0)+"ms"},unmountOnExit:!0,children:e(mt,{color:"primary",sx:{position:"fixed",bottom:{xs:16,sm:40},right:{xs:16,sm:40},zIndex:3},onClick:u,children:E})});return d(Y,{sx:{minHeight:s||!p?"100%":void 0},children:[e(pt,{}),e(We,{square:!0,variant:"outlined",sx:{margin:"0 -1px",position:"fixed",width:"calc(100% + 1px)",zIndex:3},children:d(Ee,{value:p,onChange:(u,E)=>h(E),variant:"scrollable",scrollButtons:"auto",children:[e(Z,{label:t.profiler.summary}),e(Z,{label:"Timings",disabled:!a.hasTimings}),e(Z,{label:t.profiler.plugins}),e(Z,{label:t.profiler.carbageCollection}),e(Z,{label:t.profiler.entities}),e(Z,{label:t.profiler.heap}),e(Z,{label:t.profiler.threads})]})}),e(Ee,{}),p<4&&!s?e(Y,{sx:{textAlign:"center",marginTop:"40vh"},children:t.profiler.notStarted}):c&&e(c,{},i),n(()=>r.emit("profiler:status",!s),s?e(Xe,{}):e(Ke,{}),p<4),n(()=>l(i+1),e(at,{}),p>=4)]})};export{oo as default};
