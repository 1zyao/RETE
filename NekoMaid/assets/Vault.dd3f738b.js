import{r,b as e,j as d,F as oe}from"./echarts.a2342df2.js";import{r as $,i as j,o as ne,u as ue,a as de,n as ce,l as s,g as he,s as pe,I as fe,H as P,m as k,J as me,K as ve}from"./index.6f0e4d59.js";import{r as L}from"./codemirror.220945bf.js";import{d as ge}from"./Search.2a37e9e7.js";import{W as xe,h as z,V as w,N as W,O as J,Q as K,aN as Q,f as U,w as Ce,a0 as be,G as I,D as X,a as Y,U as Se,L as _e,am as ye,C as we,q as Pe,d as Z,B as D,b as Ge,c as Me,A as ze,T as Ie,s as ke}from"./dataGrid.1fd49c94.js";var V={},De=j.exports;Object.defineProperty(V,"__esModule",{value:!0});var ee=V.default=void 0,Ne=De($()),$e=L,je=(0,Ne.default)((0,$e.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close");ee=V.default=je;var H={},Le=j.exports;Object.defineProperty(H,"__esModule",{value:!0});var N=H.default=void 0,Ve=Le($()),He=L,Te=(0,Ve.default)((0,He.jsx)("path",{d:"M3 13h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2zm4 4h14v-2H7v2zm0 4h14v-2H7v2zM7 7v2h14V7H7z"}),"List");N=H.default=Te;var T={},qe=j.exports;Object.defineProperty(T,"__esModule",{value:!0});var te=T.default=void 0,Ee=qe($()),Re=L,Fe=(0,Ee.default)((0,Re.jsx)("path",{d:"M12 12.75c1.63 0 3.07.39 4.24.9 1.08.48 1.76 1.56 1.76 2.73V18H6v-1.61c0-1.18.68-2.26 1.76-2.73 1.17-.52 2.61-.91 4.24-.91zM4 13c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm1.13 1.1c-.37-.06-.74-.1-1.13-.1-.99 0-1.93.21-2.78.58C.48 14.9 0 15.62 0 16.43V18h4.5v-1.61c0-.83.23-1.61.63-2.29zM20 13c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm4 3.43c0-.81-.48-1.53-1.22-1.85-.85-.37-1.79-.58-2.78-.58-.39 0-.76.04-1.13.1.4.68.63 1.46.63 2.29V18H24v-1.57zM12 6c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3z"}),"Groups");te=T.default=Fe;const Ae=({plugin:f,id:a,onClose:m,groups:v})=>{const[g,c]=r.exports.useState(!0),[i,h]=r.exports.useState({}),x=()=>{c(!0),f.emit("vault:playerGroup",o=>{if(!o)return;const u={};o.forEach(l=>u[l]=!0),h(u),c(!1)},a,null,0)};return r.exports.useEffect(()=>{h({}),a&&x()},[a]),d(X,{onClose:m,open:!!a,children:[e(Y,{children:s.vault.whosPermissionGroup(a)}),e(Se,{sx:{pt:0},children:v.map(o=>d(_e,{onClick:()=>{},children:[e(ye,{children:e(we,{tabIndex:-1,disabled:g,checked:!!i[o.id],onChange:u=>f.emit("vault:playerGroup",l=>{P(l),x()},a,o.id,u.target.checked?1:2)})}),e(Pe,{primary:o.id})]},o.id))}),e(Z,{children:e(D,{onClick:m,children:k["gui.back"]})})]})},Oe=({plugin:f,id:a,onClose:m,isGroup:v})=>{const[g,c]=r.exports.useState(""),[i,h]=r.exports.useState(!1),[x,o]=r.exports.useState([]);r.exports.useEffect(()=>{!a||(c(""),h(!1),f.emit("vault:getAllPermissions",l=>o(l.sort())))},[a]);const u=r.exports.useMemo(()=>me(l=>f.emit("vault:permission",h,a,l,0,v),500),[a,v]);return d(X,{open:!!a,onClose:m,children:[e(Y,{children:s.vault.editorTitle}),d(Ge,{sx:{overflow:"hidden"},children:[d(Me,{children:[s.vault.permissionInput,": ",d("span",{className:"bold",style:{},children:["(",v?s.vault.permissionGroup:k["entity.minecraft.player"],": ",a,")"]})]}),e(ze,{freeSolo:!0,options:x,sx:{marginTop:1},inputValue:g,renderInput:l=>e(Ie,{...l,label:s.vault.permission}),onInputChange:(l,_)=>{c(_),h(void 0),u(_)}}),d(U,{sx:{display:"flex",alignItems:"center",marginTop:1},children:[s.status,":",i==null?e(ke,{size:20,sx:{margin:"5px"}}):i?e(ve,{color:"success"}):e(ee,{color:"error"}),"\xA0",i!=null&&e(D,{disabled:!g,variant:"outlined",size:"small",onClick:()=>f.emit("vault:permission",l=>{P(l),h(void 0),u(g)},a,g,i?2:1,v),children:s.vault[i?"removePermission":"addPermission"]})]})]}),e(Z,{children:e(D,{onClick:m,children:k["gui.back"]})})]})},Ue=()=>{var B;const f=ne(),a=ue(),m=de(),{hasVaultPermission:v,hasVaultChat:g,vaultEconomy:c,hasVaultGroups:i}=m,[h,x]=r.exports.useState([]),[o,u]=r.exports.useState(-1),[l,_]=r.exports.useState(0),[y,ae]=r.exports.useState([]),[q,E]=r.exports.useState([]),[se,G]=r.exports.useState(),[re,R]=r.exports.useState(),[le,F]=r.exports.useState(!1),A=(B=y[0])==null?void 0:B.sort,C=t=>{t!=null&&P(t),u(-1),a.emit("vault:fetch",(n,p)=>{u(n),x(p)},l,A)};r.exports.useEffect(C,[l,A]),r.exports.useEffect(()=>{a.emit("vault:fetchGroups",E)},[]);const b=[{field:"",sortable:!1,width:60,renderCell:t=>e(xe,{src:ce(m,t.id,!0),imgProps:{crossOrigin:"anonymous",onClick(){f("/NekoMaid/playerList/"+t.id)},style:{width:40,height:40}},variant:"rounded",sx:{cursor:"pointer"}})},{field:"id",headerName:s.username,sortable:!1,width:200}],M=[{field:"id",headerName:s.vault.groupName,sortable:!1,width:160}];if(i&&b.push({field:"group",headerName:s.vault.defaultGroup,width:110,sortable:!1}),g){const t={field:"prefix",headerName:s.vault.prefix,width:110,editable:!0,sortable:!1},n={field:"suffix",headerName:s.vault.suffix,width:110,editable:!0,sortable:!1};b.push(t,n),M.push(t,n)}c&&b.push({field:"balance",headerName:s.vault.balance,editable:!0,width:110,valueFormatter:({value:t})=>(t===0||t===1?c.singular:c.plural)+(c.digits===-1?t:t.toFixed(c.digits))}),v&&(b.push({field:"_",headerName:s.operations,width:88,sortable:!1,renderCell:t=>d(oe,{children:[i&&e(z,{title:s.vault.managePermissionGroup,children:e(w,{onClick:()=>R(t.id),size:"small",children:e(te,{})})}),e(z,{title:s.vault.managePermission,children:e(w,{onClick:()=>{G(t.id),F(!1)},size:"small",children:e(N,{})})})]})}),i&&M.push({field:"_",headerName:s.operations,width:66,sortable:!1,renderCell:t=>e(z,{title:s.vault.managePermission,children:e(w,{onClick:()=>{G(t.id),F(!0)},size:"small",children:e(N,{})})})}));const O=d(W,{children:[e(J,{title:s.playerList.title,action:e(w,{onClick:()=>he(s.playerList.nameToSearch,s.username).then(t=>{if(!t)return C();u(-1),a.emit("vault:fetch",(n,p)=>{u(n),x(p),pe()},l,y.find(n=>n.field==="balance"),t.toLowerCase())}),children:e(ge,{})})}),e(K,{}),e("div",{style:{height:594,width:"100%"},children:e(Q,{pagination:!0,disableColumnMenu:!0,hideFooterSelectedRowCount:!0,rows:h,columns:b,pageSize:10,rowCount:o===-1?0:o,loading:o===-1,onPageChange:_,paginationMode:"server",sortingMode:"server",sortModel:y,onSortModelChange:t=>!fe(y,t)&&ae(t),onCellEditCommit:({field:t,id:n,value:p})=>{let S=!1;switch(t){case"balance":isNaN(+p)?C():a.emit("vault:setBalance",C,n,+p);break;case"prefix":S=!0;case"suffix":a.emit("vault:setChat",C,n,!1,S,p||null)}}})})]});return d(U,{sx:{minHeight:"100%",py:3,"& .MuiDataGrid-root":{border:"none"}},children:[e(Ce,{}),e(be,{maxWidth:!1,children:i?d(I,{container:!0,spacing:3,children:[e(I,{item:!0,lg:8,md:12,xl:8,xs:12,children:O}),e(I,{item:!0,lg:4,md:12,xl:4,xs:12,children:d(W,{children:[e(J,{title:s.vault.permissionGroup}),e(K,{}),e("div",{style:{height:594,width:"100%"},children:e(Q,{hideFooter:!0,disableColumnMenu:!0,rows:q,columns:M,onCellEditCommit:({field:t,id:n,value:p})=>{let S=!1;switch(t){case"prefix":S=!0;case"suffix":a.emit("vault:setChat",ie=>{P(ie),a.emit("vault:fetchGroups",E)},n,!0,S,p||null)}}})})]})})]}):O}),e(Oe,{plugin:a,id:se,onClose:()=>G(void 0),isGroup:le}),i&&e(Ae,{plugin:a,id:re,onClose:()=>R(void 0),groups:q})]})};export{Ue as default};
